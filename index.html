<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ß—Ç–æ –¥–ª—è –º–µ–Ω—è —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ?</title>
  <style>
    :root{
      --bg: #f6f7fb;
      --card: #ffffff;
      --card2:#fbfbfe;
      --text:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;
      --accent:#4f46e5;     /* –∏–Ω–¥–∏–≥–æ */
      --accent2:#06b6d4;    /* —Ü–∏–∞–Ω */
      --warn:#f59e0b;       /* —è–Ω—Ç–∞—Ä—å */
      --danger:#ef4444;     /* –∫—Ä–∞—Å–Ω—ã–π */
      --shadow: 0 10px 24px rgba(17,24,39,.08);
      --shadow2: 0 6px 16px rgba(17,24,39,.06);
      --radius: 18px;
      --radius2: 16px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(900px 600px at 15% 10%, rgba(79,70,229,.10), transparent 60%),
        radial-gradient(900px 650px at 90% 20%, rgba(6,182,212,.10), transparent 60%),
        radial-gradient(900px 650px at 35% 110%, rgba(245,158,11,.08), transparent 60%),
        var(--bg);
      color: var(--text);
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding: 18px;
    }

    .app{
      width: min(980px, 100%);
      display:grid;
      gap: 14px;
    }

    header{
      background: rgba(255,255,255,.85);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 16px 16px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
    }

    .title{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width: 260px;
    }

    h1{
      margin:0;
      font-size: clamp(20px, 3vw, 28px);
      letter-spacing:-.2px;
    }

    .subtitle{
      margin:0;
      color: var(--muted);
      line-height:1.45;
      font-size: 14px;
    }

    .pillRow{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:6px;
    }

    .pill{
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(79,70,229,.10);
      border: 1px solid rgba(79,70,229,.18);
      color: #1f2937;
      font-size: 12px;
      user-select:none;
    }

    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    button{
      border:0;
      border-radius: 14px;
      padding: 11px 14px;
      color: #fff;
      background: var(--accent);
      box-shadow: 0 10px 20px rgba(79,70,229,.18);
      cursor:pointer;
      font-weight: 750;
      letter-spacing:.2px;
      transition: transform .08s ease, filter .15s ease, box-shadow .15s ease;
    }
    button:hover{filter: brightness(1.03)}
    button:active{transform: translateY(1px) scale(.99)}

    button.secondary{
      color: var(--text);
      background: rgba(255,255,255,.90);
      box-shadow: var(--shadow2);
      border: 1px solid var(--border);
      font-weight: 700;
    }

    button.danger{
      background: var(--danger);
      box-shadow: 0 10px 20px rgba(239,68,68,.16);
    }

    button:disabled{
      opacity:.45;
      cursor:not-allowed;
      filter:saturate(.8);
    }

    .panel{
      background: rgba(255,255,255,.85);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 14px;
      display:grid;
      gap: 12px;
    }

    .stepBox{
      display:flex;
      gap: 12px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }

    .stepInfo{
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    .stepTitle{
      margin:0;
      font-size: 16px;
      font-weight: 850;
      letter-spacing:-.2px;
    }

    .stepHint{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }

    .counter{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .badge{
      padding: 8px 10px;
      border-radius: 12px;
      background: rgba(17,24,39,.03);
      border: 1px solid var(--border);
      font-size: 13px;
      color: var(--text);
      user-select:none;
    }
    .badge strong{color: var(--text)}
    .badge.warn{
      border-color: rgba(245,158,11,.35);
      background: rgba(245,158,11,.10);
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }
    @media (max-width: 720px){
      .grid{grid-template-columns: repeat(2, 1fr);}
    }
    @media (max-width: 420px){
      .grid{grid-template-columns: 1fr;}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,1), rgba(249,250,251,1));
      border: 1px solid var(--border);
      border-radius: var(--radius2);
      padding: 12px 12px 10px;
      box-shadow: var(--shadow2);
      display:flex;
      flex-direction:column;
      gap: 8px;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, border-color .15s ease, background .15s ease, opacity .15s ease, box-shadow .15s ease;
      position: relative;
      min-height: 92px;
    }
    .card:hover{
      transform: translateY(-1px);
      box-shadow: 0 12px 24px rgba(17,24,39,.10);
    }

    .card.selected{
      border-color: rgba(245,158,11,.55);
      background: linear-gradient(180deg, rgba(245,158,11,.12), rgba(255,255,255,1));
    }

    .card.removed{
      opacity:.45;
      filter: grayscale(.2);
      cursor: default;
    }

    .topRow{
      display:flex; align-items:center; justify-content:space-between; gap:8px;
    }

    .emoji{
      font-size: 26px;
      line-height:1;
    }

    .name{
      font-size: 15px;
      font-weight: 850;
      margin:0;
      letter-spacing:-.15px;
    }

    .mini{
      margin:0;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.35;
    }

    .tag{
      font-size: 11px;
      padding: 5px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(17,24,39,.03);
      color: #111827;
      white-space:nowrap;
    }
    .tag.removed{
      border-color: rgba(239,68,68,.28);
      background: rgba(239,68,68,.10);
      color: #7f1d1d;
    }

    .footerNote{
      color: var(--muted);
      font-size: 12px;
      line-height:1.5;
      margin: 0;
      padding-top: 2px;
    }

    .result{
      display:none;
      gap: 12px;
    }
    .result.show{display:grid;}

    .resultCard{
      background: rgba(255,255,255,.90);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: var(--shadow);
      display:grid;
      gap: 10px;
    }

    .resultTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      flex-wrap:wrap;
    }

    .big{
      display:flex;
      gap: 10px;
      align-items:center;
    }
    .big .emoji{font-size: 40px}
   .big h2{
  margin:0;
  font-size: clamp(28px, 5vw, 48px);
  font-weight: 900;
  letter-spacing: 2px;
  text-transform: uppercase;
  color: #4f46e5;
  text-align: center;
}

    .meaning{
      margin:0;
      color:#111827;
      line-height:1.55;
      font-size: 14px;
    }

    .questions{
      background: rgba(17,24,39,.03);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 12px;
      display:grid;
      gap: 8px;
    }
    .questions h3{
      margin:0;
      font-size: 14px;
      letter-spacing:-.1px;
    }
    .questions ul{
      margin:0;
      padding-left: 18px;
      color: var(--muted);
      line-height:1.6;
      font-size: 13px;
    }

    .ok{
      color:#0f172a;
      background: rgba(6,182,212,.10);
      border: 1px solid rgba(6,182,212,.25);
      padding: 10px 12px;
      border-radius: 16px;
      font-size: 13px;
      line-height:1.55;
    }

    .srOnly{
      position:absolute;
      left:-9999px;
      width:1px;height:1px;overflow:hidden;
    }
.final-highlight {
  animation: glow 1.5s ease-in-out infinite alternate;
}

@keyframes glow {
  from {
    text-shadow: 0 0 10px rgba(79,70,229,0.3);
  }
  to {
    text-shadow: 0 0 25px rgba(79,70,229,0.7);
  }
}
  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <div class="title">
        <h1>–ò–≥—Ä–∞: ¬´–ß—Ç–æ –¥–ª—è –º–µ–Ω—è —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ?¬ª</h1>
        <p class="subtitle">
          –ù–∞–∂–∏–º–∞–π –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏, —á—Ç–æ–±—ã <b>–≤—ã—á—ë—Ä–∫–∏–≤–∞—Ç—å</b> –∏—Ö.
          –£–±–∏—Ä–∞–µ–º –ø–æ —à–∞–≥–∞–º: <b>3 ‚Üí 3 ‚Üí 3 ‚Üí 2</b>. –í –∫–æ–Ω—Ü–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –æ–¥–Ω–æ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ.
        </p>
        <div class="pillRow" aria-hidden="true">
          <div class="pill">–°–≤–µ—Ç–ª—ã–π –¥–∏–∑–∞–π–Ω</div>
          <div class="pill">–ë–µ–∑ ¬´–ø—Ä–∞–≤–∏–ª—å–Ω–æ/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ¬ª</div>
          <div class="pill">–ú–æ–∂–Ω–æ –æ–±—Å—É–∂–¥–∞—Ç—å –≤ –∫–ª–∞—Å—Å–µ</div>
        </div>
      </div>
      <div class="controls">
        <button class="secondary" id="shuffleBtn" type="button">üîÄ –ü–µ—Ä–µ–º–µ—à–∞—Ç—å</button>
        <button class="secondary" id="resetBtn" type="button">‚Ü©Ô∏è –°–Ω–∞—á–∞–ª–∞</button>
      </div>
    </header>

    <section class="panel" id="gamePanel">
      <div class="stepBox">
        <div class="stepInfo">
          <p class="stepTitle" id="stepTitle">–®–∞–≥ 1</p>
          <p class="stepHint" id="stepHint">–í—ã–±–µ—Ä–∏ <b>3</b> –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö —Ç—ã –≥–æ—Ç–æ–≤ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è (–Ω–∞ –≤—Ä–µ–º—è).</p>
        </div>
        <div class="counter">
          <div class="badge warn" id="needBadge">–ù—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å: <strong id="needCount">3</strong></div>
          <div class="badge" id="leftBadge">–û—Å—Ç–∞–ª–æ—Å—å –∫–∞—Ç–µ–≥–æ—Ä–∏–π: <strong id="leftCount">12</strong></div>
          <button id="confirmBtn" type="button" disabled>‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
        </div>
      </div>

      <div class="grid" id="grid" role="list" aria-label="–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∂–∏–∑–Ω–∏"></div>

      <p class="footerNote">
        –ü–æ–¥—Å–∫–∞–∑–∫–∞: —Ç–≤–æ–π –≤—ã–±–æ—Ä ‚Äî —ç—Ç–æ –ø—Ä–æ —Ç–µ–±—è. –£ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω–∞—á–µ, –∏ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.
      </p>
    </section>

    <section class="result" id="resultPanel">
      <div class="resultCard">
        <div class="resultTop">
          <div class="big">
            <div class="emoji" id="resultEmoji">‚≠ê</div>
            <div>
              <h2 id="resultTitle">–¢–≤–æ—ë —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ</h2>
              <p class="mini" id="resultSub">–û—Å—Ç–∞–ª–∞—Å—å –æ–¥–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Äî —ç—Ç–æ —Ç–≤–æ–π –≥–ª–∞–≤–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Å–µ–π—á–∞—Å.</p>
            </div>
          </div>
          <div class="controls">
            <button class="secondary" id="backBtn" type="button">‚¨ÖÔ∏è –í–µ—Ä–Ω—É—Ç—å—Å—è</button>
            <button id="playAgainBtn" type="button">üîÅ –°—ã–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑</button>
          </div>
        </div>

        <p class="meaning" id="resultMeaning"></p>

        <div class="questions">
          <h3>–í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è:</h3>
          <ul>
            <li>–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å?</li>
            <li>–ö–∞–∫ —è –º–æ–≥—É –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ–± —ç—Ç–æ–º –≤ –∂–∏–∑–Ω–∏?</li>
            <li>–ß—Ç–æ –º–Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, –∞ —á—Ç–æ –º–µ—à–∞–µ—Ç?</li>
            <li>–•–æ—á—É –ª–∏ —è, —á—Ç–æ–±—ã —ç—Ç–æ –±—ã–ª–æ –≥–ª–∞–≤–Ω—ã–º –∏ —á–µ—Ä–µ–∑ –≥–æ–¥?</li>
          </ul>
        </div>

        <div class="ok">
          ‚ú® –í–∞–∂–Ω–æ: —É –∫–∞–∂–¥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è —Ä–∞–∑–Ω–æ–µ ‚Äî —Å–µ–º—å—è, –¥—Ä—É–∑—å—è, —É—á—ë–±–∞, –º–µ—á—Ç—ã –∏ —Ü–µ–ª–∏ –∏ —Ç.–¥.
          –ò —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å —Å–µ–±—è –∏ —É–≤–∞–∂–∞—Ç—å –≤—ã–±–æ—Ä –¥—Ä—É–≥–∏—Ö.
        </div>
      </div>
    </section>
  </div>

  <script>
    // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ó–î–û–†–û–í–¨–ï –ó–ê–ú–ï–ù–ï–ù–û –Ω–∞ "–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã")
    const DEFAULT_CATEGORIES = [
      { id:"family", name:"–°–µ–º—å—è", emoji:"üë®‚Äçüë©‚Äçüëß‚Äçüë¶", desc:"–õ—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä—è–¥–æ–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç." },
      { id:"love", name:"–õ—é–±–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫", emoji:"‚ù§Ô∏è", desc:"–ë–ª–∏–∑–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∏ —á—É–≤—Å—Ç–≤–æ –ª—é–±–≤–∏." },
      { id:"friends", name:"–î—Ä—É–∑—å—è", emoji:"üë´", desc:"–î—Ä—É–∂–±–∞, –æ–±—â–µ–Ω–∏–µ, –ø–æ–¥–¥–µ—Ä–∂–∫–∞." },
      { id:"classmates", name:"–û–¥–Ω–æ–≥—Ä—É–ø–ø–Ω–∏–∫–∏ / –æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏", emoji:"üéì", desc:"–£—á—ë–±–∞ –∏ –ª—é–¥–∏ –∏–∑ —à–∫–æ–ª—ã/–∫–æ–ª–ª–µ–¥–∂–∞." },

      // –ë—ã–ª–æ: health / "–ó–¥–æ—Ä–æ–≤—å–µ" ü©∫
      { id:"pets", name:"–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã", emoji:"üê∂", desc:"–ó–∞–±–æ—Ç–∞ –æ –∂–∏–≤–æ—Ç–Ω—ã—Ö –∏ —Ä–∞–¥–æ—Å—Ç—å –æ—Ç –æ–±—â–µ–Ω–∏—è —Å –Ω–∏–º–∏." },

      { id:"hobbies", name:"–•–æ–±–±–∏", emoji:"üé®", desc:"–¢–æ, —á—Ç–æ —Ä–∞–¥—É–µ—Ç –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è–µ—Ç." },
      { id:"study", name:"–£—á—ë–±–∞", emoji:"üìö", desc:"–ó–Ω–∞–Ω–∏—è –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ –Ω–∞–≤—ã–∫–æ–≤." },
      { id:"games", name:"–ò–≥—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è", emoji:"üéÆ", desc:"–û—Ç–¥—ã—Ö, –≤–µ—Å–µ–ª—å–µ, –ø—Ä–∏—è—Ç–Ω—ã–µ —ç–º–æ—Ü–∏–∏." },
      { id:"phone", name:"–ú–æ–±–∏–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω", emoji:"üì±", desc:"–ì–∞–¥–∂–µ—Ç—ã –∏ —É–¥–æ–±—Å—Ç–≤–æ —Å–≤—è–∑–∏." },
      { id:"social", name:"–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏", emoji:"üåê", desc:"–õ–µ–Ω—Ç–∞, –≤–∏–¥–µ–æ, –æ–±—â–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω." },
      { id:"money", name:"–î–µ–Ω—å–≥–∏", emoji:"üí∞", desc:"–ü–æ–∫—É–ø–∫–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏." },
      { id:"dreams", name:"–ú–µ—á—Ç—ã –∏ —Ü–µ–ª–∏", emoji:"‚≠ê", desc:"–¢–æ, –∫ —á–µ–º—É —Ö–æ—á–µ—Ç—Å—è –∏–¥—Ç–∏." }
    ];

    // –ü–æ—è—Å–Ω–µ–Ω–∏—è –∫ —Ñ–∏–Ω–∞–ª—É
    const MEANINGS = {
      family: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–°–µ–º—å—è¬ª</b>, –∑–Ω–∞—á–∏—Ç –¥–ª—è —Ç–µ–±—è –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã –±–ª–∏–∑–∫–∏–µ –ª—é–¥–∏, –∑–∞–±–æ—Ç–∞, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –æ—â—É—â–µ–Ω–∏–µ ¬´—è –Ω–µ –æ–¥–∏–Ω¬ª.",
      love: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–õ—é–±–∏–º—ã–π —á–µ–ª–æ–≤–µ–∫¬ª</b>, –∑–Ω–∞—á–∏—Ç –¥–ª—è —Ç–µ–±—è –≤–∞–∂–Ω–æ –±—ã—Ç—å —Ä—è–¥–æ–º —Å —Ç–µ–º, –∫–æ–≥–æ —Ç—ã –ª—é–±–∏—à—å, –∏ —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–µ–ø–ª–æ –∏ –±–ª–∏–∑–æ—Å—Ç—å.",
      friends: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–î—Ä—É–∑—å—è¬ª</b>, –∑–Ω–∞—á–∏—Ç —Ç–µ–±–µ –≤–∞–∂–Ω—ã –æ–±—â–µ–Ω–∏–µ, –¥–æ–≤–µ—Ä–∏–µ –∏ —á—É–≤—Å—Ç–≤–æ ¬´–º—ã –≤–º–µ—Å—Ç–µ¬ª.",
      classmates: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–û–¥–Ω–æ–≥—Ä—É–ø–ø–Ω–∏–∫–∏/–æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏¬ª</b>, –∑–Ω–∞—á–∏—Ç –¥–ª—è —Ç–µ–±—è –≤–∞–∂–Ω–æ –±—ã—Ç—å —á–∞—Å—Ç—å—é –∫–æ–º–∞–Ω–¥—ã –∏ —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è ¬´—Å–≤–æ–∏–º¬ª —Å—Ä–µ–¥–∏ —Å–≤–µ—Ä—Å—Ç–Ω–∏–∫–æ–≤.",
      pets: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–î–æ–º–∞—à–Ω–∏–µ –ø–∏—Ç–æ–º—Ü—ã¬ª</b>, –∑–Ω–∞—á–∏—Ç –¥–ª—è —Ç–µ–±—è –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã –∑–∞–±–æ—Ç–∞, –¥–æ–±—Ä–æ—Ç–∞ –∏ —á—É–≤—Å—Ç–≤–æ, —á—Ç–æ —Ç–µ–±—è –∂–¥—É—Ç –∏ —Ç—ã –Ω—É–∂–µ–Ω(–Ω–∞).",
      hobbies: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–•–æ–±–±–∏¬ª</b>, –∑–Ω–∞—á–∏—Ç —Ç–µ–±–µ –≤–∞–∂–Ω–æ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ —Ç–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç —Ç–µ–±—è —Å—á–∞—Å—Ç–ª–∏–≤–µ–µ –∏ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—Ä–∞–∂–∞—Ç—å —Å–µ–±—è.",
      study: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–£—á—ë–±–∞¬ª</b>, –∑–Ω–∞—á–∏—Ç —Ç–µ–±–µ –≤–∞–∂–Ω—ã –∑–Ω–∞–Ω–∏—è, —Ä–æ—Å—Ç –∏ —É–º–µ–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è —Å–∏–ª—å–Ω–µ–µ –≤ —Ç–æ–º, —á—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å.",
      games: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–ò–≥—Ä—ã –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è¬ª</b>, –∑–Ω–∞—á–∏—Ç —Ç–µ–±–µ –≤–∞–∂–Ω–æ –æ—Ç–¥—ã—Ö–∞—Ç—å, –ø–æ–ª—É—á–∞—Ç—å —Ä–∞–¥–æ—Å—Ç—å –∏ –Ω–∞—Ö–æ–¥–∏—Ç—å –≤—Ä–µ–º—è –¥–ª—è –≤–µ—Å—ë–ª–æ–π —á–∞—Å—Ç–∏ –∂–∏–∑–Ω–∏.",
      phone: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–ú–æ–±–∏–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω¬ª</b>, –∑–Ω–∞—á–∏—Ç –¥–ª—è —Ç–µ–±—è –≤–∞–∂–Ω—ã —É–¥–æ–±—Å—Ç–≤–æ, —Å–≤—è–∑—å –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ –ø–æ–ª—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.",
      social: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏¬ª</b>, –∑–Ω–∞—á–∏—Ç —Ç–µ–±–µ –≤–∞–∂–Ω–æ –±—ã—Ç—å –Ω–∞ —Å–≤—è–∑–∏, —É–∑–Ω–∞–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –∏ —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —Å–µ–±—è —á–∞—Å—Ç—å—é –æ–Ω–ª–∞–π–Ω-–º–∏—Ä–∞.",
      money: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–î–µ–Ω—å–≥–∏¬ª</b>, –∑–Ω–∞—á–∏—Ç –¥–ª—è —Ç–µ–±—è –≤–∞–∂–Ω—ã –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –∏ —á—É–≤—Å—Ç–≤–æ, —á—Ç–æ —Ç—ã –º–æ–∂–µ—à—å –º–Ω–æ–≥–æ–µ —Å–µ–±–µ –ø–æ–∑–≤–æ–ª–∏—Ç—å.",
      dreams: "–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Å—Ç–∞–ª–æ—Å—å <b>¬´–ú–µ—á—Ç—ã –∏ —Ü–µ–ª–∏¬ª</b>, –∑–Ω–∞—á–∏—Ç —Ç–µ–±–µ –≤–∞–∂–Ω–æ –∏–¥—Ç–∏ –≤–ø–µ—Ä—ë–¥, –≤–µ—Ä–∏—Ç—å –≤ —Å–µ–±—è –∏ –¥–≤–∏–≥–∞—Ç—å—Å—è –∫ —Ç–æ–º—É, —á—Ç–æ —Ö–æ—á–µ—Ç—Å—è."
    };

    const STEPS = [
      { remove: 3, label: "–®–∞–≥ 1", hint: "–í—ã–±–µ—Ä–∏ <b>3</b> –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö —Ç—ã –≥–æ—Ç–æ–≤ –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è (–Ω–∞ –≤—Ä–µ–º—è)." },
      { remove: 3, label: "–®–∞–≥ 2", hint: "–¢–µ–ø–µ—Ä—å –µ—â—ë —Ä–∞–∑: –≤—ã–±–µ—Ä–∏ <b>3</b> –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å." },
      { remove: 3, label: "–®–∞–≥ 3", hint: "–ï—â—ë —Å–ª–æ–∂–Ω–µ–µ: –≤—ã–±–µ—Ä–∏ <b>3</b> –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –æ—Ç –∫–æ—Ç–æ—Ä—ã—Ö —Ç—ã –æ—Ç–∫–∞–∂–µ—à—å—Å—è." },
      { remove: 2, label: "–®–∞–≥ 4", hint: "–§–∏–Ω–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä: —É–±–µ—Ä–∏ <b>2</b> –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –û—Å—Ç–∞–Ω–µ—Ç—Å—è —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ." }
    ];

    const grid = document.getElementById("grid");
    const confirmBtn = document.getElementById("confirmBtn");
    const resetBtn = document.getElementById("resetBtn");
    const shuffleBtn = document.getElementById("shuffleBtn");

    const stepTitle = document.getElementById("stepTitle");
    const stepHint  = document.getElementById("stepHint");
    const needCount = document.getElementById("needCount");
    const leftCount = document.getElementById("leftCount");

    const gamePanel   = document.getElementById("gamePanel");
    const resultPanel = document.getElementById("resultPanel");

    const resultEmoji  = document.getElementById("resultEmoji");
    const resultTitle  = document.getElementById("resultTitle");
    const resultMeaning= document.getElementById("resultMeaning");

    const playAgainBtn = document.getElementById("playAgainBtn");
    const backBtn      = document.getElementById("backBtn");

    let categories = [];
    let stepIndex = 0;
    let selectedIds = new Set();

    function cloneDefault(){
      return DEFAULT_CATEGORIES.map(x => ({...x, removed:false}));
    }

    function shuffleArray(arr){
      const a = [...arr];
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function currentStep(){
      return STEPS[stepIndex];
    }

    function remaining(){
      return categories.filter(c => !c.removed);
    }

    function updateHeader(){
      const step = currentStep();
      stepTitle.textContent = step.label;
      stepHint.innerHTML = step.hint;
      needCount.textContent = step.remove - selectedIds.size;
      leftCount.textContent = remaining().length;

      const need = step.remove - selectedIds.size;
      confirmBtn.disabled = need !== 0;
      confirmBtn.setAttribute("aria-disabled", String(confirmBtn.disabled));
    }

    function render(){
      grid.innerHTML = "";
      const step = currentStep();

      categories.forEach(cat => {
        const card = document.createElement("div");
        card.className = "card";
        card.setAttribute("role","listitem");
        card.setAttribute("tabindex", cat.removed ? "-1" : "0");
        card.dataset.id = cat.id;

        if(cat.removed) card.classList.add("removed");
        if(selectedIds.has(cat.id)) card.classList.add("selected");

        card.innerHTML = `
          <div class="topRow">
            <div class="emoji">${cat.emoji}</div>
            <div class="tag ${cat.removed ? "removed" : ""}">
              ${cat.removed ? "–≤—ã—á–µ—Ä–∫–Ω—É—Ç–æ" : (selectedIds.has(cat.id) ? "–≤—ã–±—Ä–∞–Ω–æ" : "–Ω–∞–∂–º–∏")}
            </div>
          </div>
          <p class="name">${cat.name}</p>
          <p class="mini">${cat.desc}</p>
          <span class="srOnly">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${cat.name}</span>
        `;

        const canSelect = !cat.removed;
        const toggle = () => {
          if(!canSelect) return;

          if(selectedIds.has(cat.id)){
            selectedIds.delete(cat.id);
          }else{
            if(selectedIds.size >= step.remove) return; // –Ω–µ –±–æ–ª—å—à–µ, —á–µ–º –Ω—É–∂–Ω–æ
            selectedIds.add(cat.id);
          }
          render();
        };

        card.addEventListener("click", toggle);
        card.addEventListener("keydown", (e)=>{
          if(e.key === "Enter" || e.key === " "){
            e.preventDefault();
            toggle();
          }
        });

        grid.appendChild(card);
      });

      updateHeader();
    }

    function confirmStep(){
      const step = currentStep();
      if(selectedIds.size !== step.remove) return;

      categories = categories.map(c => selectedIds.has(c.id) ? ({...c, removed:true}) : c);
      selectedIds.clear();

      if(remaining().length === 1){
        showResult(remaining()[0]);
        return;
      }

      stepIndex = Math.min(stepIndex + 1, STEPS.length - 1);
      render();
    }

    function showResult(finalCat){
  gamePanel.style.display = "none";
  resultPanel.classList.add("show");

  resultEmoji.textContent = finalCat.emoji;

  resultTitle.innerHTML = `
    <span class="final-highlight">
      ${finalCat.name}
    </span>
  `;

  resultMeaning.innerHTML = MEANINGS[finalCat.id] || 
    "–≠—Ç–æ —Ç–≤–æ–π –≥–ª–∞–≤–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç.";

  document.title = `–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ: ${finalCat.name}`;
}

    function backToGame(){
      resultPanel.classList.remove("show");
      gamePanel.style.display = "";
      document.title = "–ß—Ç–æ –¥–ª—è –º–µ–Ω—è —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ?";
    }

    function resetGame(){
      categories = cloneDefault();
      stepIndex = 0;
      selectedIds.clear();
      backToGame();
      render();
    }

    function shuffleGame(){
      categories = shuffleArray(categories);
      render();
    }

    confirmBtn.addEventListener("click", confirmStep);
    resetBtn.addEventListener("click", resetGame);
    shuffleBtn.addEventListener("click", shuffleGame);

    playAgainBtn.addEventListener("click", resetGame);
    backBtn.addEventListener("click", backToGame);

    resetGame();
  </script>
</body>
</html>
